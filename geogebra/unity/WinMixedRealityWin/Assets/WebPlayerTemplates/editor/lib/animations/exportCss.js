define(["require","exports","../../scripts/main","../function_helpers"],function(e,r,t,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a;!function(e){function r(e){var r={filterProperties:{}};for(var t in e)for(var n in e[t])r.filterProperties[n]||(r.filterProperties[n]=e[t][n]);return r}function a(e){var r="",t="",n="",a="",o="",s="",u="";for(var f in e.keyframes){var l=e.keyframes[f],m=e.animationsData[f];for(var c in l){var p=l[c],v=m[c],y=i(p),d=v.name;r+=d&&""!==d?u+v.name:u+f+"_"+c,t+=u+y.totalTimeToPlay+"ms",n+=u+y.start+"ms",a+=u+v.timing,o+=u+v.iteration,s+=u+v.direction,u=", ",~~y.end>~~k.totalAnimationTime&&(k.totalAnimationTime=~~y.end)}}return{names:r,end:t,start:n,timing:a,iteration:o,direction:s}}function i(e){var r=Object.keys(e),t=r[r.length-1]-r[0];return{end:r[r.length-1],start:r[0],totalTimeToPlay:t}}function o(e,r,t){var n="",a=t.end-t.start;for(var i in e){var o,k=d(parseFloat(i)-t.start,a);switch(r){case"geometry":o=s(e[i]);break;case"transform":o=c(e[i]);break;case"transform-origin":o=p(e[i]);break;case"-webkit-filter":o=v(r,e[i]);break;case"boxShadow":o=y(r,e[i]);break;case"backgroundColor":o=l(r,e[i]);break;case"styles":o="color"===e[i].property?m(r,e[i]):u(e[i]);break;case"font":o=f(e[i]);break;default:console.error("Loop keyframes error!")}n+=k+"%   { "+o.property+": "+o.value+"; }\n"}return n}function s(e){return{property:e.property,value:e.values[0]}}function u(e){return{property:n.default.convertJsToCssProperty(e.property),value:e.values[0]}}function f(e){return{property:n.default.convertJsToCssProperty(e.property),value:e.values[0]}}function l(e,r){return{property:"background-color",value:r.values[0]}}function m(e,r){return{property:"color",value:r.values[0]}}function c(e){return{property:e.property,value:e.values[0]}}function p(e){return{property:e.property,value:e.values[0]}}function v(e,r){return{property:e,value:n.default.buildFilterProps(r,!0)}}function y(e,r){return{property:"box-shadow",value:r.values[0]}}function d(e,r){return 0===e&&0===r?100:(e/r*100).toFixed(0)}var k;e.exportCss=function(e,r){return k=t.default.openFiles[r].runtimeEditor,k.totalAnimationTime=0,_(e)};var b=function(e,r){if(e)return'custom-metadata: "{"'+r+'":'+JSON.stringify(e.keyframes["-webkit-filter"])+'}";\n}'},T=function(e,r){return'transforms-metadata: "{"'+r+'":'+JSON.stringify(e.keyframes.transform)+'}";\n'},_=function(e){var n="",s=k.scene.animationClasses,u=t.default.onSelectedFileType.publishPage;for(var f in e){var l="}\n",m="",c=e[f],p=void 0;if(c.keyframes["-webkit-filter"]){var v=s[f];l=u?"}\n":b(v,f),c.keyframes["-webkit-filter"]=r(c.keyframes["-webkit-filter"]);var y=Object.keys(c.animationsData["-webkit-filter"])[0],d=c.animationsData["-webkit-filter"][y];c.animationsData["-webkit-filter"]={filterProperties:d}}else l="}\n";if(c.keyframes.transform){var _=k.scene.animationClasses[f];m=u?"":T(_,f)}if(p=a(c),c.className){n+="."+c.className+" {\nanimation-fill-mode: forwards;\nanimation-name: "+p.names+";\nanimation-duration: "+p.end+";\nanimation-timing-function: "+p.timing+";\nanimation-delay: "+p.start+";\nanimation-iteration-count: "+p.iteration+";\nanimation-direction: "+p.direction+";\n"+m+l;for(var g in c.keyframes){var P=c.keyframes[g],w=c.animationsData[g];for(var S in P){var A=P[S],N=w[S],C=o(A,g,i(A));n+="@keyframes "+(N.name&&""!==N.name?N.name:g+"_"+S+"_"+c.id)+"{\n"+C+"}\n "}}}}return""!==n?'<style id="coui_animations_block">\n'+t.default.environmentProperties.CSS_ANIMATIONS_MARK_START+"\n"+n+t.default.environmentProperties.CSS_ANIMATIONS_MARK_END+"\n</style>":""}}(a||(a={})),r.default=a});