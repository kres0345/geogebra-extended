define(["require","exports","./enums","./function_helpers","../scripts/main"],function(e,t,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;!function(e){function t(e,t){var n,a=t.currentParentElementsSelection,r=$("#sceneTree").jstree().get_selected()[0],l=$("#"+r),i=l.siblings().first().attr("data-id"),s=l.siblings().last().attr("data-id");1===a.length&&(n=e?l.next("li").attr("data-id")||i:l.prev("li").attr("data-id")||s)&&t.selectJstreeItem(n)}e.arrowKeysHandler=function(e){var t,n=r.default.openFiles[r.default.selectedEditor].runtimeEditor,l=n.currentParentElementsSelection,i=event.shiftKey?5:1;if(1===l.length){t=n.mappedWidgets[l].widget.geometry,a.default.getUnitStyle(t.top);var s=a.default.getUnitStyle(t.left);"left"!==e&&"right"!==e||"px"===s||(i*=.1),"up"!==e&&"down"!==e||"px"===s||(i*=.1)}l.length>1?(l.forEach(function(t){a.default.moveWidget({elementId:t,moveDirection:e,step:i,preserveUnits:!1})}),n.selectMultiJstreeItems(l)):1===n.currentElementsSelection.length&&(a.default.moveWidget({elementId:l[0],moveDirection:e,step:i,preserveUnits:!0}),n.computeSelectCorners($("#"+l[0])))},e.selectElement=t,e.switchElement=function(e,n){e.preventDefault(),t(!e.shiftKey,n)},e.attachKeyHandlersGlobal=function(){$("body").off("keydown"),$("body").off("keyup"),$("body").on("keydown",function(e){switch(e.which){case n.default.Keys.s:if(e.ctrlKey){e.preventDefault();var t=document.activeElement;"INPUT"===t.tagName&&null!==t.getAttribute("property")&&$(document.activeElement).blur();var a=r.default.openFiles[r.default.selectedEditor],l=a.tab.filePath+a.tab.filename;r.default.save(l,a.file.valueOf())}}})},e.attachkeyHandlersRuntimeEditor=function(e){var t=this;this.attachKeyHandlersGlobal(),$("body").on("keydown",function(a){var l=document.activeElement.tagName;if("INPUT"!==l&&"TEXTAREA"!==l){switch(a.which){case n.default.Keys.p:a.preventDefault(),e.Timeline.setPinheadPosition(0,0),e.preview("scene");break;case n.default.Keys.c:a.ctrlKey&&e.copyWidgets();break;case n.default.Keys.v:a.ctrlKey&&(e._sceneActionState.primaryAction="new action",e.cloneWidget())}if(l){var i=n.default.newScene,s=document.getElementById(i._DOMId);if(!s)return;switch(!1===s.contains(a.target)&&(a.preventDefault(),document.activeElement.blur()),a.keyCode){case n.default.Keys.left:case 16777234:t.arrowKeysHandler("left");break;case n.default.Keys.up:case 16777235:t.arrowKeysHandler("up");break;case n.default.Keys.right:case 16777236:t.arrowKeysHandler("right");break;case n.default.Keys.down:case 16777237:t.arrowKeysHandler("down");break;case n.default.Keys.tab:a.preventDefault();var d=!a.shiftKey;t.selectElement(d,e)}}}a.ctrlKey&&!1===a.shiftKey&&a.keyCode===n.default.Keys.z&&(e.undoRedoScene("undo"),r.default.autoTriggerUndoRedo("undo")),a.ctrlKey&&a.shiftKey&&a.keyCode===n.default.Keys.z&&(e.undoRedoScene("redo"),r.default.autoTriggerUndoRedo("redo"))}).keyup(function(t){var a=document.activeElement.tagName;if("INPUT"!==a&&"TEXTAREA"!==a)switch(t.which){case n.default.Keys.delete:case 16777223:t.preventDefault(),e._sceneActionState.primaryAction="new action",e.selectedKeyframes.length>0?e.Animations.deleteKeyframe():e.removeMultipleWidgets()}}),$("#sceneTree").off("keydown"),$("#sceneTree").on("keydown",function(a){a.keyCode===n.default.Keys.tab&&t.switchElement(a,e)})}}(l||(l={})),t.default=l});